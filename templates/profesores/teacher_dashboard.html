{# templates/profesores/teacher_dashboard.html #}
{% extends "base.html" %}

{% block content %}
    <h1>Bienvenido, Profesor {{ profesor.first_name }} {{ profesor.last_name }}</h1>
    <h2>Anuncios Importantes:</h2>
    <p><a href="{{ url_for('admin_create_announcement') }}">Publicar Nuevo Anuncio</a> (Solo para prueba, la ruta real para profesor sería diferente)</p> 
    {% if relevant_announcements %}
        <div style="border: 1px solid #ccc; padding: 15px; border-radius: 5px; background-color: #f9f9f9; margin-bottom: 20px;">
            {% for announcement in relevant_announcements %}
                <div style="margin-bottom: 15px; border-bottom: 1px dashed #eee; padding-bottom: 10px;">
                    <h3>{{ announcement.title }}</h3>
                    <p>{{ announcement.content }}</p>
                    <small>Publicado por {{ announcement.user.first_name }} {{ announcement.user.last_name }} el {{ announcement.date_posted.strftime('%d/%m/%Y a las %H:%M') }}</small>
                    {% if not loop.last %}
                        <hr style="border-top: 1px solid #eee;">
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No hay anuncios importantes para ti en este momento.</p>
    {% endif %}
    <h2>Tus Asignaturas Asignadas:</h2>
    {% if subjects_taught %} 
        <table border="1" style="width:100%; border-collapse: collapse;">
            <thead>
                <tr style="background-color:#f2f2f2;">
                    <th style="padding: 8px; text-align: left;">Asignatura</th>
                    <th style="padding: 8px; text-align: left;">Código</th>
                    <th style="padding: 8px; text-align: left;">Nivel(es)</th>
                    <th style="padding: 8px; text-align: left;">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects_taught %} 
                    <tr>
                        <td style="padding: 8px;">{{ subject.name }}</td>
                        <td style="padding: 8px;">{{ subject.code }}</td>
                        <td style="padding: 8px;">
                            {% for level in subject.grade_levels %}
                                {{ level.name }}{% if not loop.last %}, {% endif %}
                            {% endfor %}
                        </td>
                        <td style="padding: 8px;">
                            <a href="{{ url_for('teacher_manage_grades', subject_id=subject.id) }}">Gestionar Notas</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No tienes asignaturas asignadas aún.</p>
    {% endif %}
{% endblock %}